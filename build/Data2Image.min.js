(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/define-property"), __esModule: true };
},{"core-js/library/fn/object/define-property":4}],2:[function(require,module,exports){
"use strict";

exports["default"] = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

exports.__esModule = true;
},{}],3:[function(require,module,exports){
"use strict";

var _Object$defineProperty = require("babel-runtime/core-js/object/define-property")["default"];

exports["default"] = (function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;

      _Object$defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
})();

exports.__esModule = true;
},{"babel-runtime/core-js/object/define-property":1}],4:[function(require,module,exports){
var $ = require('../../modules/$');
module.exports = function defineProperty(it, key, desc){
  return $.setDesc(it, key, desc);
};
},{"../../modules/$":5}],5:[function(require,module,exports){
var $Object = Object;
module.exports = {
  create:     $Object.create,
  getProto:   $Object.getPrototypeOf,
  isEnum:     {}.propertyIsEnumerable,
  getDesc:    $Object.getOwnPropertyDescriptor,
  setDesc:    $Object.defineProperty,
  setDescs:   $Object.defineProperties,
  getKeys:    $Object.keys,
  getNames:   $Object.getOwnPropertyNames,
  getSymbols: $Object.getOwnPropertySymbols,
  each:       [].forEach
};
},{}],6:[function(require,module,exports){
'use strict';

var _createClass = require('babel-runtime/helpers/create-class')['default'];

var _classCallCheck = require('babel-runtime/helpers/class-call-check')['default'];

Object.defineProperty(exports, '__esModule', {
	value: true
});

var _common = require('./common');

var Data2Image = (function () {
	function Data2Image(options) {
		_classCallCheck(this, Data2Image);

		this.options = options || {};
		this.elements = [];
		this.instances = 0;
	}

	_createClass(Data2Image, [{
		key: 'addElement',
		value: function addElement(name, type, populate_callback) {
			this.elements.push({ name: name, type: type, fill: populate_callback, id: this.elements.length });
		}
	}, {
		key: 'getTotalElements',
		value: function getTotalElements() {
			return this.elements.length;
		}
	}, {
		key: 'setTotalInstances',
		value: function setTotalInstances(number) {
			this.instances = number;
		}
	}, {
		key: 'getTotalInstances',
		value: function getTotalInstances() {
			return this.instances;
		}
	}, {
		key: 'getTableSize',
		value: function getTableSize() {
			return [this.getTotalInstances(), this.getTotalElements()];
		}
	}, {
		key: 'generate',
		value: function generate() {
			var width = this.getTotalInstances();
			var height = this.getTotalElements();

			var canvas = document.createElement("canvas");
			canvas.width = width;
			canvas.height = height;

			var ctx = canvas.getContext('2d');
			var imageData = ctx.createImageData(width, height);
			var data = imageData.data;
			var index = undefined,
			    y = undefined,
			    x = undefined,
			    r = undefined,
			    i = undefined;
			var channels = 4;
			var value = undefined;

			for (y = 0; y < height; y++) {
				for (x = 0; x < width; x++) {
					index = (y * width + x) * channels;
					var v = this.elements[y].fill(x, this.elements[y]);
					value = (0, _common.encodeValue)(v, this.elements[y].type);
					for (i = 0; i < channels; i++) {
						data[index + i] = value[i];
					}
				}
			}
			ctx.putImageData(imageData, 0, 0);
			return canvas;
		}
	}, {
		key: 'version',
		value: function version() {
			return '0.0.1';
		}
	}]);

	return Data2Image;
})();

exports['default'] = Data2Image;

window.encodeValue = _common.encodeValue;
window.Data2Image = Data2Image;
module.exports = exports['default'];

},{"./common":7,"babel-runtime/helpers/class-call-check":2,"babel-runtime/helpers/create-class":3}],7:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
	value: true
});
exports.getRangeFor = getRangeFor;
exports.encodeValue = encodeValue;
function clamp(value, min, max) {
	// return Math.max(min, Math.min(max, value)); // faster??
	return value > max ? max : value < min ? min : value;
}

var ranges = {
	char: [-128, 127],
	uchar: [0, 255],
	int: [-8290688, 8290687],
	uint: [0, 16581375],
	float: [-1, 1],
	ufloat: [0, 1],
	lon: [-180, 180],
	lat: [-90, 90],
	rgb: [0, 255],
	vec2: [0, 1],
	vec3: [0, 1],
	vec4: [0, 1]
};

function getRangeFor(type) {
	return ranges[type];
}

window.getRangeFor = getRangeFor;

function encodeValue(_x, _x2) {
	var _again = true;

	_function: while (_again) {
		var value = _x,
		    type = _x2;
		_again = false;

		if (value < getRangeFor(type)[0] || value > getRangeFor(type)[1]) {
			// console.error (type + ' value ' + value + ' is out of range ' + getRangeFor(type));
			value = clamp(value, getRangeFor(type)[0], getRangeFor(type)[1]);
		}

		if (type === 'uchar') {
			return [Math.floor(value % 255), Math.floor(value % 255), Math.floor(value % 255), 255];
		} else if (type === 'char') {
			_x = value - getRangeFor(type)[0];
			_x2 = 'uchar';
			_again = true;
			continue _function;
		} else if (type === 'uint') {
			return [Math.floor(value % 255), Math.floor(value / 255) % 255, Math.floor(value / (255 * 255)), 255];
		} else if (type === 'int') {
			_x = value - getRangeFor(type)[0];
			_x2 = 'uint';
			_again = true;
			continue _function;
		} else if (type === 'float') {
			_x = .5 + value * .5;
			_x2 = 'ufloat';
			_again = true;
			continue _function;
		} else if (type === 'ufloat') {
			_x = value * 16581375;
			_x2 = 'uint';
			_again = true;
			continue _function;
		} else if (type === 'pos') {
			_x = value;
			_x2 = 'xy';
			_again = true;
			continue _function;
		} else if (type === 'xy' | type === 'vec2') {
			return [Math.floor(value[0] % 255), Math.floor(value[0] / 255) % 255, Math.floor(value[1] % 255), Math.floor(value[1] / 255) % 255];
		} else if (type === 'color') {
			_x = value;
			_x2 = 'rgb';
			_again = true;
			continue _function;
		} else if (type === 'rgb' || type === 'vec3' || type === 'vec4') {
			return [Math.floor(value[0] / getRangeFor(type)[1] * 255), Math.floor(value[1] / getRangeFor(type)[1] * 255), Math.floor(value[2] / getRangeFor(type)[1] * 255), value[3] ? Math.floor(value[3] / 255) : 255];
		}
	}
}

},{}]},{},[6])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzLWNhbGwtY2hlY2suanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZS1jbGFzcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLmpzIiwiL1VzZXJzL3BhdHJpY2lvL0Rlc2t0b3AvZGF0YTJpbWFnZS9zcmMvRGF0YTJJbWFnZS5qcyIsIi9Vc2Vycy9wYXRyaWNpby9EZXNrdG9wL2RhdGEyaW1hZ2Uvc3JjL2NvbW1vbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7c0JDWndDLFVBQVU7O0lBRTdCLFVBQVU7QUFDbEIsVUFEUSxVQUFVLENBQ2pCLE9BQU8sRUFBRTt3QkFERixVQUFVOztBQUU3QixNQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sSUFBSSxFQUFFLENBQUM7QUFDN0IsTUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7QUFD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S0FBSyxHQUFDLEVBQUU7U0FBQyxRQUFROzs7R0FDdkMsTUFDSSxJQUFJLElBQUksS0FBSyxRQUFRLEVBQUU7UUFDUixLQUFLLEdBQUMsUUFBUTtTQUFDLE1BQU07OztHQUN4QyxNQUNJLElBQUksSUFBSSxLQUFLLEtBQUssRUFBRTtRQUNMLEtBQUs7U0FBRSxJQUFJOzs7R0FDOUIsTUFDSSxJQUFJLElBQUksS0FBSyxJQUFJLEdBQUcsSUFBSSxLQUFLLE1BQU0sRUFBRTtBQUN6QyxVQUFPLENBQ04sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUMsR0FBRyxDQUFDLEVBQ2xCLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFDLEdBQUcsQ0FBQyxHQUFDLEdBQUcsRUFDNUIsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUMsR0FBRyxDQUFDLEVBQ3hCLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFDLEdBQUcsQ0FBQyxHQUFDLEdBQUcsQ0FDL0IsQ0FBQztHQUNMLE1BQ0ksSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFO1FBQ1AsS0FBSztTQUFFLEtBQUs7OztHQUMvQixNQUNJLElBQUksSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssTUFBTSxJQUFJLElBQUksS0FBSyxNQUFNLEVBQUU7QUFDOUQsVUFBTyxDQUNBLElBQUksQ0FBQyxLQUFLLENBQUMsQUFBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFFLEdBQUcsQ0FBQyxFQUMvQyxJQUFJLENBQUMsS0FBSyxDQUFDLEFBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRSxHQUFHLENBQUMsRUFDL0MsSUFBSSxDQUFDLEtBQUssQ0FBQyxBQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUUsR0FBRyxDQUFDLEVBQy9DLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBQyxHQUFHLENBQUMsR0FBRSxHQUFHLENBQzFDLENBQUM7R0FDTDtFQUNEO0NBQUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9PYmplY3QkZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIilbXCJkZWZhdWx0XCJdO1xuXG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IChmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuXG4gICAgICBfT2JqZWN0JGRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG4gIH07XG59KSgpO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOyIsInZhciAkID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy8kJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2Mpe1xuICByZXR1cm4gJC5zZXREZXNjKGl0LCBrZXksIGRlc2MpO1xufTsiLCJ2YXIgJE9iamVjdCA9IE9iamVjdDtcbm1vZHVsZS5leHBvcnRzID0ge1xuICBjcmVhdGU6ICAgICAkT2JqZWN0LmNyZWF0ZSxcbiAgZ2V0UHJvdG86ICAgJE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgaXNFbnVtOiAgICAge30ucHJvcGVydHlJc0VudW1lcmFibGUsXG4gIGdldERlc2M6ICAgICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLFxuICBzZXREZXNjOiAgICAkT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICBzZXREZXNjczogICAkT2JqZWN0LmRlZmluZVByb3BlcnRpZXMsXG4gIGdldEtleXM6ICAgICRPYmplY3Qua2V5cyxcbiAgZ2V0TmFtZXM6ICAgJE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzLFxuICBnZXRTeW1ib2xzOiAkT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyxcbiAgZWFjaDogICAgICAgW10uZm9yRWFjaFxufTsiLCJpbXBvcnQge2dldFJhbmdlRm9yLCBlbmNvZGVWYWx1ZSB9IGZyb20gJy4vY29tbW9uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGF0YTJJbWFnZSB7XG5cdGNvbnN0cnVjdG9yIChvcHRpb25zKSB7XG5cdFx0dGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0XHR0aGlzLmVsZW1lbnRzID0gW107XG5cdFx0dGhpcy5pbnN0YW5jZXMgPSAwO1xuXHR9XG5cblx0YWRkRWxlbWVudChuYW1lLCB0eXBlLCBwb3B1bGF0ZV9jYWxsYmFjaykge1xuXHRcdHRoaXMuZWxlbWVudHMucHVzaCh7IG5hbWU6IG5hbWUsIHR5cGU6IHR5cGUsIGZpbGw6IHBvcHVsYXRlX2NhbGxiYWNrLCBpZDogdGhpcy5lbGVtZW50cy5sZW5ndGggfSk7XG5cdH1cblxuXHRnZXRUb3RhbEVsZW1lbnRzKCkge1xuXHRcdHJldHVybiB0aGlzLmVsZW1lbnRzLmxlbmd0aDtcblx0fVxuXG5cdHNldFRvdGFsSW5zdGFuY2VzKG51bWJlcikge1xuXHRcdHRoaXMuaW5zdGFuY2VzID0gbnVtYmVyO1xuXHR9XG5cblx0Z2V0VG90YWxJbnN0YW5jZXMoKSB7XG5cdFx0cmV0dXJuIHRoaXMuaW5zdGFuY2VzO1xuXHR9XG5cblx0Z2V0VGFibGVTaXplKCkge1xuXHRcdHJldHVybiBbdGhpcy5nZXRUb3RhbEluc3RhbmNlcygpLCB0aGlzLmdldFRvdGFsRWxlbWVudHMoKV07XG5cdH1cblxuXHRnZW5lcmF0ZSAoKSB7XG5cdFx0bGV0IHdpZHRoID0gdGhpcy5nZXRUb3RhbEluc3RhbmNlcygpO1xuXHRcdGxldCBoZWlnaHQgPSB0aGlzLmdldFRvdGFsRWxlbWVudHMoKTtcblxuXHRcdGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuXHQgICAgY2FudmFzLndpZHRoID0gd2lkdGg7XG5cdCAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG5cdFx0bGV0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXHQgICAgbGV0IGltYWdlRGF0YSA9IGN0eC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7XG5cdCAgICBsZXQgZGF0YSA9IGltYWdlRGF0YS5kYXRhO1xuXHQgICAgbGV0IGluZGV4LCB5LCB4LCByLCBpO1x0ICAgIFx0XG5cdCAgICBsZXQgY2hhbm5lbHMgPSA0O1xuXHQgICAgbGV0IHZhbHVlO1xuXG5cdCAgICBmb3IgKHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHtcblx0ICAgICAgICBmb3IgKHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuXHQgICAgICAgICAgICBpbmRleCA9ICh5KndpZHRoK3gpKmNoYW5uZWxzO1xuXHQgICAgICAgICAgICBsZXQgdiA9IHRoaXMuZWxlbWVudHNbeV0uZmlsbCh4LCB0aGlzLmVsZW1lbnRzW3ldKTtcblx0XHRcdFx0dmFsdWUgPSBlbmNvZGVWYWx1ZSh2LCB0aGlzLmVsZW1lbnRzW3ldLnR5cGUpO1xuXHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgY2hhbm5lbHM7IGkrKykge1xuXHRcdFx0XHRcdGRhdGFbaW5kZXgraV0gPSB2YWx1ZVtpXTtcblx0XHRcdFx0fVxuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIGN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcblx0ICAgIHJldHVybiBjYW52YXM7XG5cdH1cblxuXHR2ZXJzaW9uICgpIHtcbiAgICAgICAgcmV0dXJuICcwLjAuMSc7XG4gICAgfVxufVxuXG53aW5kb3cuZW5jb2RlVmFsdWUgPSBlbmNvZGVWYWx1ZTtcbndpbmRvdy5EYXRhMkltYWdlID0gRGF0YTJJbWFnZTsiLCJmdW5jdGlvbiBjbGFtcCh2YWx1ZSwgbWluLCBtYXgpIHtcblx0Ly8gcmV0dXJuIE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCB2YWx1ZSkpOyAvLyBmYXN0ZXI/P1xuXHRyZXR1cm4gKHZhbHVlID4gbWF4ID8gbWF4IDogdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSk7XG59XG5cbnZhciByYW5nZXMgPSB7XG5cdGNoYXI6IFstMTI4LCAxMjddLFxuXHR1Y2hhcjogWzAsIDI1NV0sXG5cdGludDogWy04MjkwNjg4LCA4MjkwNjg3XSxcblx0dWludDogWzAsIDE2NTgxMzc1XSxcblx0ZmxvYXQ6IFstMSwgMV0sXG5cdHVmbG9hdDogWzAsIDFdLFxuXHRsb246IFstMTgwLDE4MF0sXG5cdGxhdDogWy05MCw5MF0sXG5cdHJnYjogWzAsIDI1NV0sXG5cdHZlYzI6IFswLCAxXSxcblx0dmVjMzogWzAsIDFdLFxuXHR2ZWM0OiBbMCwgMV0sXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmFuZ2VGb3IodHlwZSkge1xuXHRyZXR1cm4gcmFuZ2VzW3R5cGVdO1xufVxud2luZG93LmdldFJhbmdlRm9yID0gZ2V0UmFuZ2VGb3I7XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmNvZGVWYWx1ZSAodmFsdWUsIHR5cGUpIHtcblx0aWYgKHZhbHVlIDwgZ2V0UmFuZ2VGb3IodHlwZSlbMF0gfHwgdmFsdWUgPiBnZXRSYW5nZUZvcih0eXBlKVsxXSkge1xuXHRcdC8vIGNvbnNvbGUuZXJyb3IgKHR5cGUgKyAnIHZhbHVlICcgKyB2YWx1ZSArICcgaXMgb3V0IG9mIHJhbmdlICcgKyBnZXRSYW5nZUZvcih0eXBlKSk7XG5cdFx0dmFsdWUgPSBjbGFtcCh2YWx1ZSxnZXRSYW5nZUZvcih0eXBlKVswXSxnZXRSYW5nZUZvcih0eXBlKVsxXSk7XG5cdH1cblxuXHRpZiAodHlwZSA9PT0gJ3VjaGFyJykge1xuXHQgICAgcmV0dXJuIFtcblx0ICAgICAgICBNYXRoLmZsb29yKHZhbHVlJTI1NSksXG5cdCAgICAgICAgTWF0aC5mbG9vcih2YWx1ZSUyNTUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWUlMjU1KSxcblx0ICAgICAgICAyNTVcblx0ICAgIF07XG5cdH1cblx0ZWxzZSBpZiAodHlwZSA9PT0gJ2NoYXInKSB7XG5cdFx0cmV0dXJuIGVuY29kZVZhbHVlKHZhbHVlIC0gZ2V0UmFuZ2VGb3IodHlwZSlbMF0sJ3VjaGFyJyk7XG5cdH1cblx0ZWxzZSBpZiAodHlwZSA9PT0gJ3VpbnQnKSB7XG5cdCAgICByZXR1cm4gW1xuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWUlMjU1KSxcblx0ICAgICAgICBNYXRoLmZsb29yKHZhbHVlLzI1NSklMjU1LFxuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWUvKDI1NSoyNTUpKSxcblx0ICAgICAgICAyNTVcblx0ICAgIF07XG5cdH1cblx0ZWxzZSBpZiAodHlwZSA9PT0gJ2ludCcpIHtcblx0XHRyZXR1cm4gZW5jb2RlVmFsdWUodmFsdWUgLSBnZXRSYW5nZUZvcih0eXBlKVswXSwndWludCcpO1xuXHR9XG5cdGVsc2UgaWYgKHR5cGUgPT09ICdmbG9hdCcpIHtcblx0XHRyZXR1cm4gZW5jb2RlVmFsdWUoLjUrdmFsdWUqLjUsJ3VmbG9hdCcpO1xuXHR9XG5cdGVsc2UgaWYgKHR5cGUgPT09ICd1ZmxvYXQnKSB7XG5cdFx0cmV0dXJuIGVuY29kZVZhbHVlKHZhbHVlKjE2NTgxMzc1LCd1aW50Jyk7XG5cdH1cblx0ZWxzZSBpZiAodHlwZSA9PT0gJ3BvcycpIHtcblx0XHRyZXR1cm4gZW5jb2RlVmFsdWUodmFsdWUsICd4eScpO1xuXHR9XG5cdGVsc2UgaWYgKHR5cGUgPT09ICd4eScgfCB0eXBlID09PSAndmVjMicpIHtcblx0XHRyZXR1cm4gW1xuXHRcdFx0TWF0aC5mbG9vcih2YWx1ZVswXSUyNTUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWVbMF0vMjU1KSUyNTUsXG5cdCAgICAgICAgTWF0aC5mbG9vcih2YWx1ZVsxXSUyNTUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWVbMV0vMjU1KSUyNTVcblx0ICAgIF07XG5cdH1cblx0ZWxzZSBpZiAodHlwZSA9PT0gJ2NvbG9yJykge1xuXHRcdHJldHVybiBlbmNvZGVWYWx1ZSh2YWx1ZSwgJ3JnYicpO1xuXHR9XG5cdGVsc2UgaWYgKHR5cGUgPT09ICdyZ2InIHx8IHR5cGUgPT09ICd2ZWMzJyB8fCB0eXBlID09PSAndmVjNCcpIHtcblx0XHRyZXR1cm4gW1xuXHQgICAgICAgIE1hdGguZmxvb3IoKHZhbHVlWzBdL2dldFJhbmdlRm9yKHR5cGUpWzFdKSoyNTUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IoKHZhbHVlWzFdL2dldFJhbmdlRm9yKHR5cGUpWzFdKSoyNTUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IoKHZhbHVlWzJdL2dldFJhbmdlRm9yKHR5cGUpWzFdKSoyNTUpLFxuXHQgICAgICAgIHZhbHVlWzNdPyBNYXRoLmZsb29yKHZhbHVlWzNdLzI1NSk6IDI1NVxuXHQgICAgXTtcblx0fVxufSJdfQ==
