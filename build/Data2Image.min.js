(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/math/sign"), __esModule: true };
},{"core-js/library/fn/math/sign":6}],2:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/number/epsilon"), __esModule: true };
},{"core-js/library/fn/number/epsilon":7}],3:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/define-property"), __esModule: true };
},{"core-js/library/fn/object/define-property":8}],4:[function(require,module,exports){
"use strict";

exports["default"] = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

exports.__esModule = true;
},{}],5:[function(require,module,exports){
"use strict";

var _Object$defineProperty = require("babel-runtime/core-js/object/define-property")["default"];

exports["default"] = (function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;

      _Object$defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
})();

exports.__esModule = true;
},{"babel-runtime/core-js/object/define-property":3}],6:[function(require,module,exports){
require('../../modules/es6.math.sign');
module.exports = require('../../modules/$.core').Math.sign;
},{"../../modules/$.core":10,"../../modules/es6.math.sign":16}],7:[function(require,module,exports){
require('../../modules/es6.number.epsilon');
module.exports = Math.pow(2, -52);
},{"../../modules/es6.number.epsilon":17}],8:[function(require,module,exports){
var $ = require('../../modules/$');
module.exports = function defineProperty(it, key, desc){
  return $.setDesc(it, key, desc);
};
},{"../../modules/$":14}],9:[function(require,module,exports){
module.exports = function(it){
  if(typeof it != 'function')throw TypeError(it + ' is not a function!');
  return it;
};
},{}],10:[function(require,module,exports){
var core = module.exports = {version: '1.2.6'};
if(typeof __e == 'number')__e = core; // eslint-disable-line no-undef
},{}],11:[function(require,module,exports){
// optional / simple context binding
var aFunction = require('./$.a-function');
module.exports = function(fn, that, length){
  aFunction(fn);
  if(that === undefined)return fn;
  switch(length){
    case 1: return function(a){
      return fn.call(that, a);
    };
    case 2: return function(a, b){
      return fn.call(that, a, b);
    };
    case 3: return function(a, b, c){
      return fn.call(that, a, b, c);
    };
  }
  return function(/* ...args */){
    return fn.apply(that, arguments);
  };
};
},{"./$.a-function":9}],12:[function(require,module,exports){
var global    = require('./$.global')
  , core      = require('./$.core')
  , ctx       = require('./$.ctx')
  , PROTOTYPE = 'prototype';

var $export = function(type, name, source){
  var IS_FORCED = type & $export.F
    , IS_GLOBAL = type & $export.G
    , IS_STATIC = type & $export.S
    , IS_PROTO  = type & $export.P
    , IS_BIND   = type & $export.B
    , IS_WRAP   = type & $export.W
    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})
    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE]
    , key, own, out;
  if(IS_GLOBAL)source = name;
  for(key in source){
    // contains in native
    own = !IS_FORCED && target && key in target;
    if(own && key in exports)continue;
    // export native or passed
    out = own ? target[key] : source[key];
    // prevent global pollution for namespaces
    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]
    // bind timers to global for call from export context
    : IS_BIND && own ? ctx(out, global)
    // wrap global constructors for prevent change them in library
    : IS_WRAP && target[key] == out ? (function(C){
      var F = function(param){
        return this instanceof C ? new C(param) : C(param);
      };
      F[PROTOTYPE] = C[PROTOTYPE];
      return F;
    // make static versions for prototype methods
    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;
    if(IS_PROTO)(exports[PROTOTYPE] || (exports[PROTOTYPE] = {}))[key] = out;
  }
};
// type bitmap
$export.F = 1;  // forced
$export.G = 2;  // global
$export.S = 4;  // static
$export.P = 8;  // proto
$export.B = 16; // bind
$export.W = 32; // wrap
module.exports = $export;
},{"./$.core":10,"./$.ctx":11,"./$.global":13}],13:[function(require,module,exports){
// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();
if(typeof __g == 'number')__g = global; // eslint-disable-line no-undef
},{}],14:[function(require,module,exports){
var $Object = Object;
module.exports = {
  create:     $Object.create,
  getProto:   $Object.getPrototypeOf,
  isEnum:     {}.propertyIsEnumerable,
  getDesc:    $Object.getOwnPropertyDescriptor,
  setDesc:    $Object.defineProperty,
  setDescs:   $Object.defineProperties,
  getKeys:    $Object.keys,
  getNames:   $Object.getOwnPropertyNames,
  getSymbols: $Object.getOwnPropertySymbols,
  each:       [].forEach
};
},{}],15:[function(require,module,exports){
// 20.2.2.28 Math.sign(x)
module.exports = Math.sign || function sign(x){
  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;
};
},{}],16:[function(require,module,exports){
// 20.2.2.28 Math.sign(x)
var $export = require('./$.export');

$export($export.S, 'Math', {sign: require('./$.math-sign')});
},{"./$.export":12,"./$.math-sign":15}],17:[function(require,module,exports){
// 20.1.2.1 Number.EPSILON
var $export = require('./$.export');

$export($export.S, 'Number', {EPSILON: Math.pow(2, -52)});
},{"./$.export":12}],18:[function(require,module,exports){
'use strict';

var _createClass = require('babel-runtime/helpers/create-class')['default'];

var _classCallCheck = require('babel-runtime/helpers/class-call-check')['default'];

var _Math$sign = require('babel-runtime/core-js/math/sign')['default'];

Object.defineProperty(exports, '__esModule', {
	value: true
});

var _common = require('./common');

// Default Ranges
var ranges = {
	number: [-16581375, 16581375],
	char: [-128, 127],
	uchar: [0, 255],
	int: [-8290688, 8290687],
	uint: [0, 16581375],
	float: [-1, 1],
	ufloat: [0, 1],
	color: [0, 255],
	rgb: [0, 255],
	position: [-1, 1],
	vec2: [-1, 1],
	vec3: [-1, 1],
	vec4: [-1, 1]
};

// Class

var Data2Image = (function () {
	function Data2Image(options) {
		_classCallCheck(this, Data2Image);

		this.options = options || {};
		this.elements = [];
		this.instances = 0;
	}

	_createClass(Data2Image, [{
		key: 'addElement',
		value: function addElement(name, type, populate_callback, range) {
			this.elements.push({ id: this.elements.length, name: name, type: type, range: range, fill: populate_callback });
		}
	}, {
		key: 'getTotalElements',
		value: function getTotalElements() {
			return this.elements.length;
		}
	}, {
		key: 'setTotalInstances',
		value: function setTotalInstances(number) {
			this.instances = number;
		}
	}, {
		key: 'getTotalInstances',
		value: function getTotalInstances() {
			return this.instances;
		}
	}, {
		key: 'getTableSize',
		value: function getTableSize() {
			return [this.getTotalInstances(), this.getTotalElements()];
		}
	}, {
		key: 'generate',
		value: function generate() {
			var width = this.getTotalInstances();
			var height = this.getTotalElements();

			var canvas = document.createElement("canvas");
			canvas.width = width;
			canvas.height = height;

			var ctx = canvas.getContext('2d');
			var imageData = ctx.createImageData(width, height);
			var data = imageData.data;
			var index = undefined,
			    y = undefined,
			    x = undefined,
			    r = undefined,
			    i = undefined;
			var channels = 4;
			var value = undefined;

			for (y = 0; y < height; y++) {
				for (x = 0; x < width; x++) {
					index = (y * width + x) * channels;
					var v = this.elements[y].fill(x, this.elements[y]);
					value = encodeValue(v, this.elements[y].type, this.elements[y].range);
					for (i = 0; i < channels; i++) {
						data[index + i] = value[i];
					}
				}
			}
			ctx.putImageData(imageData, 0, 0);
			return canvas;
		}
	}, {
		key: 'version',
		value: function version() {
			return '0.0.2';
		}
	}]);

	return Data2Image;
})();

exports['default'] = Data2Image;

function getRangeFor(type) {
	return ranges[type];
}

function clampValue(value, range) {
	if (value < range[0] || value > range[1]) {
		console.log('Value', value, 'is out of range', range, 'will be clamped to', value);
		return (0, _common.clamp)(value, range[0], range[1]);
	} else {
		return value;
	}
}

function normalizeValue(value, range) {
	return (0, _common.map)(value, range[0], range[1], 0, 1);
}

function encodeValue(value, type, range) {
	if (!range) {
		range = getRangeFor(type);
	}

	if (typeof value === 'number') {
		value = clampValue(value, range);
		if (type !== 'number') {
			// "Number" type don't need normaliztion because tries to set the presition dinamically
			value = normalizeValue(value, range);
		}
	} else if (Array.isArray(value)) {
		for (var i in value) {
			value[i] = clampValue(value[i], range);
			if (type !== 'number') {
				// "Number" type don't need normaliztion because tries to set the presition dinamically
				value[i] = normalizeValue(value[i], range);
			}
		}
	} else {
		console.log('Value type could not be read', value, type, range);
		return;
	}

	if (type === 'uchar' || type === 'char') {
		value *= 255;
		return [Math.floor(value), Math.floor(value), Math.floor(value), 255];
	} else if (type === 'int' || type === 'uint' || type === 'float' || type === 'ufloat') {
		value = value * 16581375;
		return [Math.floor(value % 255), Math.floor(value / 255) % 255, Math.floor(value / (255 * 255)), 255];
	} else if (type === 'number') {
		var s = _Math$sign(value);
		var d = (0, _common.decimals)(value) + 1.;
		var uint = Math.abs(value) * Math.pow(10, d); // transform the number into unsigned integers
		var pres = 244 + d * s;
		// console.log("Value:",value,"S:",s,"D:",d,"Uint:",uint,"Press:",pres);
		return [Math.floor(uint % 255), Math.floor(uint / 255) % 255, Math.floor(uint / (255 * 255)), pres];
	} else if (type === position || type === 'vec2') {
		var x = value[0] * 65025;
		var y = value[1] * 65025;
		return [Math.floor(x % 255), Math.floor(x / 255) % 255, Math.floor(y % 255), Math.floor(y / 255) % 255];
	} else if (type === 'color' || type === 'rgb' || type === 'vec3' || type === 'vec4') {
		return [Math.floor(value[0] * 255), Math.floor(value[1] * 255), Math.floor(value[2] * 255), value[3] ? Math.floor(value[3] * 255) : 255];
	}
}

window.Data2Image = Data2Image;
module.exports = exports['default'];

},{"./common":19,"babel-runtime/core-js/math/sign":1,"babel-runtime/helpers/class-call-check":4,"babel-runtime/helpers/create-class":5}],19:[function(require,module,exports){
'use strict';

var _Number$EPSILON = require('babel-runtime/core-js/number/epsilon')['default'];

Object.defineProperty(exports, '__esModule', {
    value: true
});
exports.clamp = clamp;
exports.map = map;
exports.decimals = decimals;

function clamp(value, min, max) {
    // return Math.max(min, Math.min(max, value)); // faster??
    return value > max ? max : value < min ? min : value;
}

function map(value, inputMin, inputMax, outputMin, outputMax) {
    var clamp = arguments.length <= 5 || arguments[5] === undefined ? true : arguments[5];

    if (Math.abs(inputMin - inputMax) < _Number$EPSILON) {
        return outputMin;
    } else {
        var outVal = (value - inputMin) / (inputMax - inputMin) * (outputMax - outputMin) + outputMin;
        if (clamp) {
            if (outputMax < outputMin) {
                if (outVal < outputMax) {
                    outVal = outputMax;
                } else if (outVal > outputMin) {
                    outVal = outputMin;
                }
            } else {
                if (outVal > outputMax) {
                    outVal = outputMax;
                } else if (outVal < outputMin) {
                    outVal = outputMin;
                }
            }
        }
        return outVal;
    }
}

function decimals(number) {
    var match = (Math.abs(number) + '').match(/\d+\.(\d+)/);
    return match ? match[1].length : 0;
}

},{"babel-runtime/core-js/number/epsilon":2}]},{},[18])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL21hdGgvc2lnbi5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvbnVtYmVyL2Vwc2lsb24uanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzLWNhbGwtY2hlY2suanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZS1jbGFzcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vbWF0aC9zaWduLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9udW1iZXIvZXBzaWxvbi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLmEtZnVuY3Rpb24uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5jb3JlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuY3R4LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuZXhwb3J0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuZ2xvYmFsLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5tYXRoLXNpZ24uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm1hdGguc2lnbi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYubnVtYmVyLmVwc2lsb24uanMiLCIvVXNlcnMvcGF0cmljaW8vRGVza3RvcC9kYXRhMmltYWdlL3NyYy9EYXRhMkltYWdlLmpzIiwiL1VzZXJzL3BhdHJpY2lvL0Rlc2t0b3AvZGF0YTJpbWFnZS9zcmMvY29tbW9uLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7O0FDQUE7O0FDQUE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTs7QUNEQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFD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QUFJLE1BQU0sR0FBRyxTQUFTLEVBQUU7QUFDdkIsMEJBQU0sR0FBRyxTQUFTLENBQUM7aUJBQ25CLE1BQ0ksSUFBSSxNQUFNLEdBQUcsU0FBUyxFQUFHO0FBQzdCLDBCQUFNLEdBQUcsU0FBUyxDQUFDO2lCQUNuQjthQUNKLE1BQ0k7QUFDRCxvQkFBSSxNQUFNLEdBQUcsU0FBUyxFQUFFO0FBQ3ZCLDBCQUFNLEdBQUcsU0FBUyxDQUFDO2lCQUNuQixNQUNJLElBQUksTUFBTSxHQUFHLFNBQVMsRUFBRztBQUM3QiwwQkFBTSxHQUFHLFNBQVMsQ0FBQztpQkFDbkI7YUFDSjtTQUNKO0FBQ0QsZUFBTyxNQUFNLENBQUM7S0FDakI7Q0FDSjs7QUFFTSxTQUFTLFFBQVEsQ0FBQyxNQUFNLEVBQUU7QUFDaEMsUUFBSSxLQUFLLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQSxDQUFFLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUN4RCxXQUFPLEtBQUssR0FBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztDQUNsQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vbWF0aC9zaWduXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL251bWJlci9lcHNpbG9uXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9PYmplY3QkZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIilbXCJkZWZhdWx0XCJdO1xuXG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IChmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuXG4gICAgICBfT2JqZWN0JGRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG4gIH07XG59KSgpO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOyIsInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2Lm1hdGguc2lnbicpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzLyQuY29yZScpLk1hdGguc2lnbjsiLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5udW1iZXIuZXBzaWxvbicpO1xubW9kdWxlLmV4cG9ydHMgPSBNYXRoLnBvdygyLCAtNTIpOyIsInZhciAkID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy8kJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2Mpe1xuICByZXR1cm4gJC5zZXREZXNjKGl0LCBrZXksIGRlc2MpO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTtcbiAgcmV0dXJuIGl0O1xufTsiLCJ2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcxLjIuNid9O1xuaWYodHlwZW9mIF9fZSA9PSAnbnVtYmVyJylfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmIiwiLy8gb3B0aW9uYWwgLyBzaW1wbGUgY29udGV4dCBiaW5kaW5nXG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi8kLmEtZnVuY3Rpb24nKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7XG4gIGFGdW5jdGlvbihmbik7XG4gIGlmKHRoYXQgPT09IHVuZGVmaW5lZClyZXR1cm4gZm47XG4gIHN3aXRjaChsZW5ndGgpe1xuICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKGEpe1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7XG4gICAgfTtcbiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbihhLCBiKXtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpO1xuICAgIH07XG4gICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24oYSwgYiwgYyl7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBmdW5jdGlvbigvKiAuLi5hcmdzICovKXtcbiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTtcbiAgfTtcbn07IiwidmFyIGdsb2JhbCAgICA9IHJlcXVpcmUoJy4vJC5nbG9iYWwnKVxuICAsIGNvcmUgICAgICA9IHJlcXVpcmUoJy4vJC5jb3JlJylcbiAgLCBjdHggICAgICAgPSByZXF1aXJlKCcuLyQuY3R4JylcbiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJztcblxudmFyICRleHBvcnQgPSBmdW5jdGlvbih0eXBlLCBuYW1lLCBzb3VyY2Upe1xuICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRlxuICAgICwgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuR1xuICAgICwgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuU1xuICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUFxuICAgICwgSVNfQklORCAgID0gdHlwZSAmICRleHBvcnQuQlxuICAgICwgSVNfV1JBUCAgID0gdHlwZSAmICRleHBvcnQuV1xuICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSlcbiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV1cbiAgICAsIGtleSwgb3duLCBvdXQ7XG4gIGlmKElTX0dMT0JBTClzb3VyY2UgPSBuYW1lO1xuICBmb3Ioa2V5IGluIHNvdXJjZSl7XG4gICAgLy8gY29udGFpbnMgaW4gbmF0aXZlXG4gICAgb3duID0gIUlTX0ZPUkNFRCAmJiB0YXJnZXQgJiYga2V5IGluIHRhcmdldDtcbiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7XG4gICAgLy8gZXhwb3J0IG5hdGl2ZSBvciBwYXNzZWRcbiAgICBvdXQgPSBvd24gPyB0YXJnZXRba2V5XSA6IHNvdXJjZVtrZXldO1xuICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlc1xuICAgIGV4cG9ydHNba2V5XSA9IElTX0dMT0JBTCAmJiB0eXBlb2YgdGFyZ2V0W2tleV0gIT0gJ2Z1bmN0aW9uJyA/IHNvdXJjZVtrZXldXG4gICAgLy8gYmluZCB0aW1lcnMgdG8gZ2xvYmFsIGZvciBjYWxsIGZyb20gZXhwb3J0IGNvbnRleHRcbiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKVxuICAgIC8vIHdyYXAgZ2xvYmFsIGNvbnN0cnVjdG9ycyBmb3IgcHJldmVudCBjaGFuZ2UgdGhlbSBpbiBsaWJyYXJ5XG4gICAgOiBJU19XUkFQICYmIHRhcmdldFtrZXldID09IG91dCA/IChmdW5jdGlvbihDKXtcbiAgICAgIHZhciBGID0gZnVuY3Rpb24ocGFyYW0pe1xuICAgICAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIEMgPyBuZXcgQyhwYXJhbSkgOiBDKHBhcmFtKTtcbiAgICAgIH07XG4gICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07XG4gICAgICByZXR1cm4gRjtcbiAgICAvLyBtYWtlIHN0YXRpYyB2ZXJzaW9ucyBmb3IgcHJvdG90eXBlIG1ldGhvZHNcbiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7XG4gICAgaWYoSVNfUFJPVE8pKGV4cG9ydHNbUFJPVE9UWVBFXSB8fCAoZXhwb3J0c1tQUk9UT1RZUEVdID0ge30pKVtrZXldID0gb3V0O1xuICB9XG59O1xuLy8gdHlwZSBiaXRtYXBcbiRleHBvcnQuRiA9IDE7ICAvLyBmb3JjZWRcbiRleHBvcnQuRyA9IDI7ICAvLyBnbG9iYWxcbiRleHBvcnQuUyA9IDQ7ICAvLyBzdGF0aWNcbiRleHBvcnQuUCA9IDg7ICAvLyBwcm90b1xuJGV4cG9ydC5CID0gMTY7IC8vIGJpbmRcbiRleHBvcnQuVyA9IDMyOyAvLyB3cmFwXG5tb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7IiwiLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzg2I2lzc3VlY29tbWVudC0xMTU3NTkwMjhcbnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aFxuICA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5pZih0eXBlb2YgX19nID09ICdudW1iZXInKV9fZyA9IGdsb2JhbDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZiIsInZhciAkT2JqZWN0ID0gT2JqZWN0O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNyZWF0ZTogICAgICRPYmplY3QuY3JlYXRlLFxuICBnZXRQcm90bzogICAkT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICBpc0VudW06ICAgICB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxcbiAgZ2V0RGVzYzogICAgJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gIHNldERlc2M6ICAgICRPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gIHNldERlc2NzOiAgICRPYmplY3QuZGVmaW5lUHJvcGVydGllcyxcbiAgZ2V0S2V5czogICAgJE9iamVjdC5rZXlzLFxuICBnZXROYW1lczogICAkT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsXG4gIGdldFN5bWJvbHM6ICRPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzLFxuICBlYWNoOiAgICAgICBbXS5mb3JFYWNoXG59OyIsIi8vIDIwLjIuMi4yOCBNYXRoLnNpZ24oeClcbm1vZHVsZS5leHBvcnRzID0gTWF0aC5zaWduIHx8IGZ1bmN0aW9uIHNpZ24oeCl7XG4gIHJldHVybiAoeCA9ICt4KSA9PSAwIHx8IHggIT0geCA/IHggOiB4IDwgMCA/IC0xIDogMTtcbn07IiwiLy8gMjAuMi4yLjI4IE1hdGguc2lnbih4KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuLyQuZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnTWF0aCcsIHtzaWduOiByZXF1aXJlKCcuLyQubWF0aC1zaWduJyl9KTsiLCIvLyAyMC4xLjIuMSBOdW1iZXIuRVBTSUxPTlxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuLyQuZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnTnVtYmVyJywge0VQU0lMT046IE1hdGgucG93KDIsIC01Mil9KTsiLCJpbXBvcnQgeyBjbGFtcCwgbWFwLCBkZWNpbWFscyB9IGZyb20gJy4vY29tbW9uJztcblxuLy8gRGVmYXVsdCBSYW5nZXNcbnZhciByYW5nZXMgPSB7XG5cdG51bWJlcjogWy0xNjU4MTM3NSwxNjU4MTM3NV0sXG5cdGNoYXI6IFx0Wy0xMjgsIDEyN10sXG5cdHVjaGFyOiBcdFswLCAyNTVdLFxuXHRpbnQ6IFx0Wy04MjkwNjg4LCA4MjkwNjg3XSxcblx0dWludDogXHRbMCwgMTY1ODEzNzVdLFxuXHRmbG9hdDogXHRbLTEsIDFdLFxuXHR1ZmxvYXQ6IFswLCAxXSxcblx0Y29sb3I6IFx0WzAsIDI1NV0sXG5cdHJnYjogXHRbMCwgMjU1XSxcblx0cG9zaXRpb246IFstMSwgMV0sXG5cdHZlYzI6IFx0Wy0xLCAxXSxcblx0dmVjMzogXHRbLTEsIDFdLFxuXHR2ZWM0OiBcdFstMSwgMV1cbn07XG5cbi8vIENsYXNzXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEYXRhMkltYWdlIHtcblx0Y29uc3RydWN0b3IgKG9wdGlvbnMpIHtcblx0XHR0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHRcdHRoaXMuZWxlbWVudHMgPSBbXTtcblx0XHR0aGlzLmluc3RhbmNlcyA9IDA7XG5cdH1cblxuXHRhZGRFbGVtZW50IChuYW1lLCB0eXBlLCBwb3B1bGF0ZV9jYWxsYmFjaywgcmFuZ2UpIHtcblx0XHR0aGlzLmVsZW1lbnRzLnB1c2goeyBpZDogdGhpcy5lbGVtZW50cy5sZW5ndGgsIG5hbWU6IG5hbWUsIHR5cGU6IHR5cGUsIHJhbmdlOiByYW5nZSwgZmlsbDogcG9wdWxhdGVfY2FsbGJhY2sgfSk7XG5cdH1cblxuXHRnZXRUb3RhbEVsZW1lbnRzICgpIHtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50cy5sZW5ndGg7XG5cdH1cblxuXHRzZXRUb3RhbEluc3RhbmNlcyAobnVtYmVyKSB7XG5cdFx0dGhpcy5pbnN0YW5jZXMgPSBudW1iZXI7XG5cdH1cblxuXHRnZXRUb3RhbEluc3RhbmNlcyAoKSB7XG5cdFx0cmV0dXJuIHRoaXMuaW5zdGFuY2VzO1xuXHR9XG5cblx0Z2V0VGFibGVTaXplICgpIHtcblx0XHRyZXR1cm4gW3RoaXMuZ2V0VG90YWxJbnN0YW5jZXMoKSwgdGhpcy5nZXRUb3RhbEVsZW1lbnRzKCldO1xuXHR9XG5cblx0Z2VuZXJhdGUgKCkge1xuXHRcdGxldCB3aWR0aCA9IHRoaXMuZ2V0VG90YWxJbnN0YW5jZXMoKTtcblx0XHRsZXQgaGVpZ2h0ID0gdGhpcy5nZXRUb3RhbEVsZW1lbnRzKCk7XG5cblx0XHRsZXQgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcblx0ICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoO1xuXHQgICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcblxuXHRcdGxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblx0ICAgIGxldCBpbWFnZURhdGEgPSBjdHguY3JlYXRlSW1hZ2VEYXRhKHdpZHRoLCBoZWlnaHQpO1xuXHQgICAgbGV0IGRhdGEgPSBpbWFnZURhdGEuZGF0YTtcblx0ICAgIGxldCBpbmRleCwgeSwgeCwgciwgaTtcdCAgICBcdFxuXHQgICAgbGV0IGNoYW5uZWxzID0gNDtcblx0ICAgIGxldCB2YWx1ZTtcblxuXHQgICAgZm9yICh5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7XG5cdCAgICAgICAgZm9yICh4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHtcblx0ICAgICAgICAgICAgaW5kZXggPSAoeSp3aWR0aCt4KSpjaGFubmVscztcblx0ICAgICAgICAgICAgbGV0IHYgPSB0aGlzLmVsZW1lbnRzW3ldLmZpbGwoeCwgdGhpcy5lbGVtZW50c1t5XSk7XG5cdFx0XHRcdHZhbHVlID0gZW5jb2RlVmFsdWUodiwgdGhpcy5lbGVtZW50c1t5XS50eXBlLCB0aGlzLmVsZW1lbnRzW3ldLnJhbmdlKTtcblx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IGNoYW5uZWxzOyBpKyspIHtcblx0XHRcdFx0XHRkYXRhW2luZGV4K2ldID0gdmFsdWVbaV07XG5cdFx0XHRcdH1cblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICBjdHgucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG5cdCAgICByZXR1cm4gY2FudmFzO1xuXHR9XG5cblx0dmVyc2lvbiAoKSB7XG4gICAgICAgIHJldHVybiAnMC4wLjInO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0UmFuZ2VGb3IgKHR5cGUpIHtcblx0cmV0dXJuIHJhbmdlc1t0eXBlXTtcbn1cblxuZnVuY3Rpb24gY2xhbXBWYWx1ZSAodmFsdWUsIHJhbmdlKSB7XG5cdGlmICh2YWx1ZSA8IHJhbmdlWzBdIHx8IHZhbHVlID4gcmFuZ2VbMV0pIHtcblx0XHRjb25zb2xlLmxvZygnVmFsdWUnLHZhbHVlLCdpcyBvdXQgb2YgcmFuZ2UnLHJhbmdlLCd3aWxsIGJlIGNsYW1wZWQgdG8nLHZhbHVlKTtcblx0XHRyZXR1cm4gY2xhbXAodmFsdWUscmFuZ2VbMF0scmFuZ2VbMV0pO1xuXHR9XG5cdGVsc2Uge1xuXHRcdHJldHVybiB2YWx1ZTtcblx0fVxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVWYWx1ZSAodmFsdWUsIHJhbmdlKSB7XG5cdHJldHVybiBtYXAodmFsdWUscmFuZ2VbMF0scmFuZ2VbMV0sMCwxKTtcbn1cblxuZnVuY3Rpb24gZW5jb2RlVmFsdWUgKHZhbHVlLCB0eXBlLCByYW5nZSkge1xuXHRpZiAoIXJhbmdlKSB7XG5cdFx0cmFuZ2UgPSBnZXRSYW5nZUZvcih0eXBlKTtcblx0fVxuXG5cdGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG5cdFx0dmFsdWUgPSBjbGFtcFZhbHVlKHZhbHVlLCByYW5nZSk7XG5cdFx0aWYgKHR5cGUgIT09ICdudW1iZXInKSB7XG5cdFx0XHQvLyBcIk51bWJlclwiIHR5cGUgZG9uJ3QgbmVlZCBub3JtYWxpenRpb24gYmVjYXVzZSB0cmllcyB0byBzZXQgdGhlIHByZXNpdGlvbiBkaW5hbWljYWxseVxuXHRcdFx0dmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSwgcmFuZ2UpO1xuXHRcdH1cblx0fSBcblx0ZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHRmb3IgKGxldCBpIGluIHZhbHVlKSB7XG5cdFx0XHR2YWx1ZVtpXSA9IGNsYW1wVmFsdWUodmFsdWVbaV0sIHJhbmdlKTtcblx0XHRcdGlmICh0eXBlICE9PSAnbnVtYmVyJykge1xuXHRcdFx0XHQvLyBcIk51bWJlclwiIHR5cGUgZG9uJ3QgbmVlZCBub3JtYWxpenRpb24gYmVjYXVzZSB0cmllcyB0byBzZXQgdGhlIHByZXNpdGlvbiBkaW5hbWljYWxseVxuXHRcdFx0XHR2YWx1ZVtpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlW2ldLCByYW5nZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IFxuXHRlbHNlIHtcblx0XHRjb25zb2xlLmxvZygnVmFsdWUgdHlwZSBjb3VsZCBub3QgYmUgcmVhZCcsIHZhbHVlLCB0eXBlLCByYW5nZSk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdFxuXHRpZiAodHlwZSA9PT0gJ3VjaGFyJyB8fCB0eXBlID09PSAnY2hhcicpIHtcblx0XHR2YWx1ZSAqPSAyNTU7XG5cdCAgICByZXR1cm4gW1xuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWUpLFxuXHQgICAgICAgIDI1NVxuXHQgICAgXTtcblx0fVxuXHRlbHNlIGlmICh0eXBlID09PSAnaW50JyB8fCB0eXBlID09PSAndWludCcgIHx8IHR5cGUgPT09ICdmbG9hdCcgfHwgdHlwZSA9PT0gJ3VmbG9hdCcpIHtcblx0XHR2YWx1ZSA9IHZhbHVlKjE2NTgxMzc1O1xuXHQgICAgcmV0dXJuIFtcblx0ICAgICAgICBNYXRoLmZsb29yKHZhbHVlJTI1NSksXG5cdCAgICAgICAgTWF0aC5mbG9vcih2YWx1ZS8yNTUpJTI1NSxcblx0ICAgICAgICBNYXRoLmZsb29yKHZhbHVlLygyNTUqMjU1KSksXG5cdCAgICAgICAgMjU1XG5cdCAgICBdO1xuXHR9XG5cdGVsc2UgaWYgKHR5cGUgPT09ICdudW1iZXInKSB7XG5cdFx0bGV0IHMgPSBNYXRoLnNpZ24odmFsdWUpO1xuXHRcdGxldCBkID0gZGVjaW1hbHModmFsdWUpKzEuO1xuXHRcdGxldCB1aW50ID0gTWF0aC5hYnModmFsdWUpICogTWF0aC5wb3coMTAsZCk7XHQvLyB0cmFuc2Zvcm0gdGhlIG51bWJlciBpbnRvIHVuc2lnbmVkIGludGVnZXJzXG5cdFx0bGV0IHByZXMgPSAyNDQgKyBkKnM7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJWYWx1ZTpcIix2YWx1ZSxcIlM6XCIscyxcIkQ6XCIsZCxcIlVpbnQ6XCIsdWludCxcIlByZXNzOlwiLHByZXMpO1xuXHQgICAgcmV0dXJuIFtcblx0ICAgICAgICBNYXRoLmZsb29yKHVpbnQlMjU1KSxcblx0ICAgICAgICBNYXRoLmZsb29yKHVpbnQvMjU1KSUyNTUsXG5cdCAgICAgICAgTWF0aC5mbG9vcih1aW50LygyNTUqMjU1KSksXG5cdCAgICAgICAgcHJlc1xuXHQgICAgXTtcblx0fVxuXHRlbHNlIGlmICh0eXBlID09PSBwb3NpdGlvbiB8fCB0eXBlID09PSAndmVjMicpIHtcdFx0XHRcdFxuXHRcdGxldCB4ID0gdmFsdWVbMF0qNjUwMjU7XG5cdFx0bGV0IHkgPSB2YWx1ZVsxXSo2NTAyNTtcblx0XHRyZXR1cm4gW1xuXHRcdFx0TWF0aC5mbG9vcih4JTI1NSksXG5cdCAgICAgICAgTWF0aC5mbG9vcih4LzI1NSklMjU1LFxuXHQgICAgICAgIE1hdGguZmxvb3IoeSUyNTUpLFxuXHQgICAgICAgIE1hdGguZmxvb3IoeS8yNTUpJTI1NVxuXHQgICAgXTtcblx0fVxuXHRlbHNlIGlmICh0eXBlID09PSAnY29sb3InIHx8IHR5cGUgPT09ICdyZ2InIHx8IHR5cGUgPT09ICd2ZWMzJyB8fCB0eXBlID09PSAndmVjNCcpIHtcblx0XHRyZXR1cm4gW1xuXHQgICAgICAgIE1hdGguZmxvb3IodmFsdWVbMF0qMjU1KSxcblx0ICAgICAgICBNYXRoLmZsb29yKHZhbHVlWzFdKjI1NSksXG5cdCAgICAgICAgTWF0aC5mbG9vcih2YWx1ZVsyXSoyNTUpLFxuXHQgICAgICAgIHZhbHVlWzNdID8gTWF0aC5mbG9vcih2YWx1ZVszXSoyNTUpOiAyNTVcblx0ICAgIF07XG5cdH1cbn1cblxud2luZG93LkRhdGEySW1hZ2UgPSBEYXRhMkltYWdlOyIsImV4cG9ydCBmdW5jdGlvbiBjbGFtcCh2YWx1ZSwgbWluLCBtYXgpIHtcblx0Ly8gcmV0dXJuIE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCB2YWx1ZSkpOyAvLyBmYXN0ZXI/P1xuXHRyZXR1cm4gKHZhbHVlID4gbWF4ID8gbWF4IDogdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXAodmFsdWUsIGlucHV0TWluLCBpbnB1dE1heCwgb3V0cHV0TWluLCBvdXRwdXRNYXgsIGNsYW1wID0gdHJ1ZSApIHtcbiAgICBpZiAoTWF0aC5hYnMoaW5wdXRNaW4gLSBpbnB1dE1heCkgPCBOdW1iZXIuRVBTSUxPTikge1xuICAgICAgICByZXR1cm4gb3V0cHV0TWluO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBvdXRWYWwgPSAoKHZhbHVlIC0gaW5wdXRNaW4pIC8gKGlucHV0TWF4IC0gaW5wdXRNaW4pICogKG91dHB1dE1heCAtIG91dHB1dE1pbikgKyBvdXRwdXRNaW4pO1xuICAgICAgICBpZiAoY2xhbXApIHtcbiAgICAgICAgICAgIGlmIChvdXRwdXRNYXggPCBvdXRwdXRNaW4pIHtcbiAgICAgICAgICAgICAgICBpZiAob3V0VmFsIDwgb3V0cHV0TWF4KSB7XG4gICAgICAgICAgICAgICAgXHRvdXRWYWwgPSBvdXRwdXRNYXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYoIG91dFZhbCA+IG91dHB1dE1pbiApIHtcbiAgICAgICAgICAgICAgICBcdG91dFZhbCA9IG91dHB1dE1pbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG91dFZhbCA+IG91dHB1dE1heCkge1xuICAgICAgICAgICAgICAgIFx0b3V0VmFsID0gb3V0cHV0TWF4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmKCBvdXRWYWwgPCBvdXRwdXRNaW4gKSB7XG4gICAgICAgICAgICAgICAgXHRvdXRWYWwgPSBvdXRwdXRNaW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRWYWw7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjaW1hbHMobnVtYmVyKSB7XG5cdGxldCBtYXRjaCA9IChNYXRoLmFicyhudW1iZXIpICsgJycpLm1hdGNoKC9cXGQrXFwuKFxcZCspLyk7XG5cdHJldHVybiBtYXRjaD8gbWF0Y2hbMV0ubGVuZ3RoIDogMDtcbn0iXX0=
